# DA-ETL-Python-SQL

Стек: python, библиотека pandahouse
 
**Задачи**:
* Необходимо написать оптимальный запрос, который даст информацию о количестве очень усердных студентов.(Под усердным студентом мы понимаем студента, который правильно решил 20 задач за текущий месяц)
* Необходимо в одном запросе выгрузить следующую информацию о тестовой и контрольной группах пользователей:
    * ARPU 
    * ARPAU 
    * CR в покупку 
    * СR активного пользователя в покупку 
    * CR пользователя из активности по математике (subject = ’math’) в покупку курса по математике

**Результаты**: 

Запрос 1:

<img width="583" alt="Снимок экрана 2024-02-28 в 15 20 04" src="https://github.com/ekaterina-drozd/DA-ETL-Python-SQL/assets/158583245/16f1cb16-b591-4b5e-aed4-65668f1c87b8">

* Количество очень усердных студентов:  136

  
Запрос 2

<img width="977" alt="Снимок экрана 2024-02-28 в 15 20 23" src="https://github.com/ekaterina-drozd/DA-ETL-Python-SQL/assets/158583245/aa18e6f3-958b-437f-959b-ce78c2d1913d">

* Сводная таблица метрик:

<img width="583" alt="Снимок экрана 2024-02-28 в 15 17 07" src="https://github.com/ekaterina-drozd/DA-ETL-Python-SQL/assets/158583245/30c693e8-1c78-4712-a8d9-e8c23205bb49">


