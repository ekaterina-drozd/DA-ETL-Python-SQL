# DA-ETL-Python-SQL
 
**Задачи**:
* Необходимо написать оптимальный запрос, который даст информацию о количестве очень усердных студентов.(Под усердным студентом мы понимаем студента, который правильно решил 20 задач за текущий месяц)
* Необходимо в одном запросе выгрузить следующую информацию о тестовой и контрольной группах пользователей:
    * ARPU 
    * ARPAU 
    * CR в покупку 
    * СR активного пользователя в покупку 
    * CR пользователя из активности по математике (subject = ’math’) в покупку курса по математике

Стек: SQL, python, библиотека pandahouse

**Этапы работы:**
- провела предварительный анализ данных
- писала оптимальные SQL-запросы
- выявила количество усердных учеников (отобрала нужные колонки, посчитала сумму правильных ответов, сгруппировала по st_id и месяцу, отобрала данные с кол-вом правильных ответов 20 и более)
- подсчитала метрики в тестовой и контрольной группах: ARPU, ARPAU, CR в покупку, СR активного пользователя в покупку (сджойнила все таблицы по st_id, перенесла джоин в подзапрос, сагрегировала данные в дф peas(подзапрос внутри подзапроса), рассчитала метрики и округлила их до 2 знаков после запятой, сгруппировала)
- выполняла SQL-запросы с помощью Python

**Результаты**: 

Запрос 1:

<img width="583" alt="Снимок экрана 2024-02-28 в 15 20 04" src="https://github.com/ekaterina-drozd/DA-ETL-Python-SQL/assets/158583245/16f1cb16-b591-4b5e-aed4-65668f1c87b8">

* Количество очень усердных студентов:  136

  
Запрос 2

<img width="977" alt="Снимок экрана 2024-02-28 в 15 20 23" src="https://github.com/ekaterina-drozd/DA-ETL-Python-SQL/assets/158583245/aa18e6f3-958b-437f-959b-ce78c2d1913d">

* Сводная таблица метрик:

<img width="583" alt="Снимок экрана 2024-02-28 в 15 17 07" src="https://github.com/ekaterina-drozd/DA-ETL-Python-SQL/assets/158583245/30c693e8-1c78-4712-a8d9-e8c23205bb49">


